<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="https://bootswatch.com/4/darkly/bootstrap.min.css"
    />
    <script
      src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
      crossorigin="anonymous"
    ></script>
    <style>
      @font-face {
        font-family: "Lexend Deca Regular";
        src: url(../fonts/LexendDecaRegular.woff) format("woff");
        font-weight: 400;
        font-style: normal;
      }

      html {
        background-color: #26262b;
        font-family: "Lexend Deca Regular";
      }

      body {
        margin: 0;
        min-width: 250px;
        font-family: "Lexend Deca Regular";
        background-color: #26262b;
      }

      li:nth-child(odd) {
        background: #414141;
      }

      li:nth-child(even) {
        background: #303030;
      }

      li {
        vertical-align: middle;
      }

      li.badge {
        vertical-align: middle;
        margin-top: -0.5em;
      }

      .hidden {
        display: none;
      }

      .invite-btn {
        background: linear-gradient(
          90deg,
          rgba(255, 93, 0, 1) 0,
          rgba(255, 217, 25, 1) 100%
        );
        border-radius: 0px 10px 10px 0px;
        color: #dde9f8;
        display: inline;
      }

      svg {
          fill: white;
      }
    </style>
  </head>

  <body>
    <svg class="hidden">
        <symbol viewBox="0 0 512 512" id="settings">
            <path d="M256 133.61c-67.484 0-122.39 54.906-122.39 122.39S188.515 378.39 256 378.39 378.39 323.485 378.39 256 323.485 133.61 256 133.61zm0 214.183c-50.613 0-91.793-41.18-91.793-91.793s41.18-91.793 91.793-91.793 91.793 41.18 91.793 91.793-41.18 91.793-91.793 91.793zm0 0"></path>
            <path d="M499.953 197.703l-39.351-8.555a214.162 214.162 0 0 0-12.664-30.539l21.785-33.886a15.302 15.302 0 0 0-2.051-19.09l-61.305-61.305a15.302 15.302 0 0 0-19.09-2.05l-33.886 21.785a214.162 214.162 0 0 0-30.54-12.665l-8.554-39.351A15.298 15.298 0 0 0 299.347 0h-86.695a15.298 15.298 0 0 0-14.949 12.047l-8.555 39.351a214.162 214.162 0 0 0-30.539 12.664l-33.886-21.785a15.302 15.302 0 0 0-19.09 2.051l-61.305 61.305a15.302 15.302 0 0 0-2.05 19.09l21.785 33.886a214.162 214.162 0 0 0-12.665 30.54l-39.351 8.554A15.301 15.301 0 0 0 0 212.653v86.695a15.301 15.301 0 0 0 12.047 14.949l39.351 8.555a214.162 214.162 0 0 0 12.665 30.539l-21.786 33.886a15.302 15.302 0 0 0 2.051 19.09l61.305 61.305a15.302 15.302 0 0 0 19.09 2.05l33.886-21.785a214.162 214.162 0 0 0 30.54 12.665l8.554 39.351A15.298 15.298 0 0 0 212.653 512h86.695a15.298 15.298 0 0 0 14.949-12.047l8.555-39.351a214.162 214.162 0 0 0 30.539-12.665l33.886 21.786a15.297 15.297 0 0 0 19.09-2.051l61.305-61.305a15.302 15.302 0 0 0 2.05-19.09l-21.784-33.886a214.162 214.162 0 0 0 12.664-30.54l39.351-8.554A15.301 15.301 0 0 0 512 299.347v-86.695a15.301 15.301 0 0 0-12.047-14.949zm-18.55 89.313l-36.083 7.843a15.307 15.307 0 0 0-11.488 10.84 183.563 183.563 0 0 1-16.95 40.88 15.294 15.294 0 0 0 .454 15.792l19.98 31.078-43.863 43.867-31.082-19.98a15.287 15.287 0 0 0-15.789-.453 183.67 183.67 0 0 1-40.883 16.949 15.307 15.307 0 0 0-10.84 11.488l-7.843 36.082h-62.032l-7.843-36.082a15.307 15.307 0 0 0-10.84-11.488 183.563 183.563 0 0 1-40.88-16.95 15.303 15.303 0 0 0-15.792.454l-31.078 19.98-43.864-43.867 19.977-31.078a15.294 15.294 0 0 0 .457-15.793A183.76 183.76 0 0 1 78.168 305.7a15.302 15.302 0 0 0-11.484-10.84l-36.086-7.843v-62.032l36.082-7.843a15.307 15.307 0 0 0 11.488-10.84 183.563 183.563 0 0 1 16.95-40.88 15.294 15.294 0 0 0-.454-15.792l-19.98-31.078 43.863-43.867 31.082 19.98a15.287 15.287 0 0 0 15.789.453 183.67 183.67 0 0 1 40.883-16.949 15.307 15.307 0 0 0 10.84-11.488l7.843-36.082h62.032l7.843 36.082a15.307 15.307 0 0 0 10.84 11.488 183.563 183.563 0 0 1 40.88 16.95 15.303 15.303 0 0 0 15.792-.454l31.078-19.98 43.863 43.867-19.976 31.078a15.294 15.294 0 0 0-.457 15.793 183.576 183.576 0 0 1 16.953 40.879 15.302 15.302 0 0 0 11.484 10.84l36.086 7.843zm0 0"></path>
        </symbol>
    </svg>
    <div class="b-cont" style="width: 60vw; margin: 0 auto; margin-top: 10px;">
      <h1 align="center" style="color: #dde9f8; font-size: 2.5rem;">
        Team
      </h1>
      <div class="input-group">
        <input
          id="myInput"
          type="text"
          onkeyup="myFunction()"
          class="form-control"
          style="border-radius: 10px 0px 0px 10px; background-color: #dde9f8; color: #36393f; display: inline;"
          placeholder="Search by keyword..."
        />
        <span class="input-group-btn">
          <button
            class="btn btn-primary invite-btn"
            data-toggle="modal"
            data-target="#exampleModalCenter"
          >
            Invite Members
          </button>
        </span>
      </div>
      <br />
      <div
        class="modal fade"
        id="exampleModalCenter"
        tabindex="-1"
        role="dialog"
        aria-labelledby="exampleModalCenterTitle"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLongTitle">
                Invite a User!
              </h5>
              <button
                type="button"
                class="close"
                data-dismiss="modal"
                aria-label="Close"
              >
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <textarea
                class="form-control"
                rows="4"
                id="ctext"
                readonly
              ></textarea>
              <br />
              <div
                class="alert alert-dismissible alert-primary hidden"
                id="alrt"
              >
                <button type="button" class="close" id="dismiss">
                  &times;
                </button>
                <strong>Copied Successfully!</strong>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary" id="copy">
                Copy
              </button>
              <button
                type="button"
                class="btn btn-secondary"
                data-dismiss="modal"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>
      <ul id="myUL" class="list-group"></ul>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-app.js"></script>

    <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-analytics.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-firestore.js"></script>
    <script>
      function myFunction() {
        var input, filter, ul, li, a, i, txtValue;
        input = document.getElementById("myInput");
        filter = input.value.toUpperCase();
        ul = document.getElementById("myUL");
        li = ul.getElementsByTagName("li");
        for (i = 0; i < li.length; i++) {
          a = li[i].getElementsByTagName("a")[0];
          txtValue = a.textContent || a.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            li[i].style.display = "";
          } else {
            li[i].style.display = "none";
          }
        }
      }

      var config = {
        apiKey: "AIzaSyAFsWpVKy1bjsOM07arnzk5UYIUZz7qxGY",
        authDomain: "https://spark-2121.web.app/",
        databseURL: "https://spark-2121.firebaseio.com/",
        projectId: "spark-2121",
      };

      if (firebase.apps.length === 0) {
        firebase.initializeApp(config);
      }

      const db = firebase.firestore();
      const auth = firebase.auth();
      const sparkroom = "{{ sparkroom }}";

      auth.onAuthStateChanged(function (user) {
        console.log(user);
      });

      $(document).ready(function () {
        $("#copy").click(function () {
          $("#alrt").toggleClass("hidden");
          var copyText = document.getElementById("ctext");
          copyText.select();
          copyText.setSelectionRange(0, 99999);
          document.execCommand("copy");
        });
        $("#dismiss").click(function () {
          $("#alrt").toggleClass("hidden");
        });
        var docRef = db.collection("sparkrooms").doc(sparkroom);
        docRef.get().then(function (doc) {
          var users = doc.data().users;
          var password = doc.data().password;
          $("#ctext").val(
            "Hey there, want to join my SparkRoom?\nJust click this link and sign up! https://sparkapp.cf/join/" +
              sparkroom +
              ":" +
              password +
              ".\nThe room name is " +
              sparkroom +
              " and the password is " +
              password
          );
          for (var i = 0; i < users.length; i++) {
            var user = users[i];
            var uname = user.uname;
            var id = user.user;
            var admin = user.admin;
            var creator = user.creator;
            var li = document.createElement("li");
            li.id = id;
            if (creator !== undefined) {
              li.innerHTML = "<a>" + uname + " </a>" + '<span class="badge badge-success">ADMIN</span> <span class="badge badge-success">CREATOR</span>';
            } else if (admin) {
              li.innerHTML = "<a>" + uname + " </a>" + '<span class="badge badge-success">ADMIN</span>';
            } else {
              li.innerHTML = "<a>" + uname + "<svg><use xlink:href='#settings'></use></svg></a>";
            }
            li.classList = "list-group-item";
            document.getElementById("myUL").appendChild(li);
          }
        });
      });
    </script>
  </body>
</html>
